(skrócona wersja – pełny kod w poprzednich krokach)